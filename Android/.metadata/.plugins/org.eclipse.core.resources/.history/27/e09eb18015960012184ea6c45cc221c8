package edu.hci.annoyingapp.activities;

import edu.hci.annoyingapp.AnnoyingApplication;
import edu.hci.annoyingapp.R;
import edu.hci.annoyingapp.dialogs.AnnoyingDialog;
import android.content.DialogInterface;
import android.content.DialogInterface.OnCancelListener;
import android.content.DialogInterface.OnDismissListener;
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.util.Log;
import android.view.Window;

public class AnnoyingActivity extends FragmentActivity implements OnDismissListener, OnCancelListener {

	private static final String TAG = AnnoyingActivity.class.getSimpleName();
	private static final boolean DEBUG_MODE = AnnoyingApplication.DEBUG_MODE;
	
	private static int mStackLevel = 0;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);

		requestWindowFeature(Window.FEATURE_NO_TITLE);
		setContentView(R.layout.activity_annoying_blank);

		/*
		 * Button yesBt = (Button)
		 * findViewById(R.id.activity_annoying_yes_button); if(yesBt != null) {
		 * yesBt.setOnClickListener(this); }
		 * 
		 * Button noBt = (Button)
		 * findViewById(R.id.activity_annoying_no_button); if(noBt != null) {
		 * noBt.setOnClickListener(this); }
		 */
		/*
		 * getWindow().addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD
		 * | WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED |
		 * WindowManager.LayoutParams.FLAG_FULLSCREEN |
		 * WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON);
		 */

		// To Use if you want the phone to vibrate!
		// Vibrator myVib = (Vibrator) this.getSystemService(VIBRATOR_SERVICE);
		// myVib.vibrate(1000);

	}

	@Override
	protected void onStart() {
		super.onStart();

		/*
		// 1. Instantiate an AlertDialog.Builder with its constructor
		AlertDialog.Builder builder = new AlertDialog.Builder(this);

		// 2. Chain together various setter methods to set the dialog
		// characteristics
		builder.setMessage(R.string.dialog_text).setTitle(TAG);

		builder.setPositiveButton(android.R.string.yes, new DialogInterface.OnClickListener() {
	           public void onClick(DialogInterface dialog, int id) {
	               // User clicked OK button
	        	   finish();
	           }
	       });
		builder.setNegativeButton(android.R.string.no, new DialogInterface.OnClickListener() {
	           public void onClick(DialogInterface dialog, int id) {
	               // User clicked Cancel button
	        	   //Do nothing
	           }
	       });

		// 3. Get the AlertDialog from create()
		AlertDialog dialog = builder.create();

		
		dialog.setOnDismissListener(this);
		dialog.setCanceledOnTouchOutside(false);
		dialog.setOnCancelListener(this);
		dialog.setCancelable(false);
		
		dialog.show();
		 */
		
		
		AnnoyingApplication.mIsDialogRunning = true;
	}

	@Override
	protected void onStop() {
		super.onStop();

		AnnoyingApplication.mIsDialogRunning = false;
	}
	
	void showDialog() {

	    FragmentManager fm = getSupportFragmentManager();
		AnnoyingDialog ad = (AnnoyingDialog) fm.findFragmentByTag(AnnoyingDialog.TAG);
	    if (ad == null) {
	    	ad = AnnoyingDialog.newInstance();
	    	ad.show(fm.beginTransaction(), AnnoyingDialog.TAG);
	    }
	}

	/*
	 * @Override public void onClick(View v) { if (v.getId() ==
	 * R.id.activity_annoying_yes_button) { finish(); } else if (v.getId() ==
	 * R.id.activity_annoying_no_button) { // Do stuff } }
	 */

	@Override
	public void onDismiss(DialogInterface dialog) {
		if (DEBUG_MODE) {
			Log.d(TAG, "Dismissed");
		}
		finish();
	}

	@Override
	public void onCancel(DialogInterface dialog) {
		if (DEBUG_MODE) {
			Log.d(TAG, "Cancelled");
		}
	}
}
